# Product Requirements Document: ClockBlock

## 1. Executive Summary

**ClockBlock** is a "connected" time management system for a 10-year-old Minecraft player. Unlike traditional parental controls that rely on hard restrictions (app killing), ClockBlock focuses on **awareness, autonomy, and economic consequences**.

It uses a local "listener" to track gameplay and a cloud backend to sync status in real-time, allowing for a flexible "Debt & Savings" economy that teaches time budgeting skills.

## 2. Technical Strategy (The "Vibe Code" Approach)

**Constraint:** The implementation details should be selected and generated by the AI agent within the development environment. The user will act as the "Master Builder" guiding the AI.

- **Development Environment:** VSCode (with Codex) or Google IDX/Antigravity (with Gemini 3).
- **Architecture:** Hybrid IoT-style system.
    - **Local Agent:** A lightweight script (Python recommended) running on the child's PC. Detects `Minecraft.exe` and reports heartbeat to cloud.
    - **Cloud Backend:** Supabase (Auth, Database, Realtime subscriptions).
    - **Dashboard:** Web-based UI (React/Vite recommended) for Child (HUD) and Parent (Remote Control).

## 3. Core Mechanics (The "Rules of the Game")

### A. The Schedule & Daily Allowance (The Rules)

- **Granular Daily Allowances:**
    - System supports specific limits per day of the week (not just Weekday/Weekend split), allowing for lower limits on busy activity days (e.g., Soccer Practice Tuesdays).
    - **Default Baseline:**
        - **Weekdays (Mon-Thu, Sun):** 60 Minutes (6 "Diamonds").
        - **Weekends (Fri-Sat):** 120 Minutes (12 "Diamonds").
- **Allowed Time Windows (The Curfew):**
    - Defines *when* the allowance can be spent (e.g., "08:00 AM to 08:30 PM").
    - **Enforcement:** Playing outside these hours triggers the "Night Owl" state (visual warning) or "Lockdown" (if strict mode is on).
- **Reset Time:** 4:00 AM local time.

### B. Usage Tracking (The Meter)

- **Detection Method:** Simple Process Check.
    - If `Minecraft.exe` is running, time is deducted.
    - **AFK Rule:** "The Meter is Always Running." No idle detection. Teaches the habit of closing apps when walking away.
- **Sync:** Local agent pings Supabase every 60 seconds to deduct balance.

### C. The Economy (Consequences)

- **Rollover (The Bank):**
    - Unused minutes from any day roll over to a "Weekend Bank."
    - **Cap:** Maximum 60 minutes can be banked. (Prevents unhealthy binges).
- **Overdraft (The Debt):**
    - Play is **not** blocked when time runs out.
    - **The Cost:** Continuing to play past 0 sends the balance into negative.
    - **Interest Rate:** 2x Penalty. For every 1 minute played in "Overdraft," **2 minutes** are deducted from the *next day's* budget.
    - *Example:* Playing 10 mins over on Tuesday reduces Wednesday's budget by 20 mins.

### D. Enforcement (Visual Only)

- **State 1 (Green/Blue):** Budget > 0. Normal play.
- **State 2 (Red/Warning):** Budget < 0.
    - **Visual:** The dashboard bar turns red and pulses.
    - **No "Nag":** No annoying sounds or pop-ups. The only consequence is the accumulating Debt.

### E. Parental Override (God Mode)

- Parent can log into the web dashboard on mobile.
- **Actions:**
    - **Grant:** Add one-time bonus minutes (e.g., "Finish your raid").
    - **Penalty:** Manually deduct minutes.

### F. The Scheduler (Dashboard UI)

- **Parent View (Configuration):**
    - A clean list view of the 7 days (Mon-Sun).
    - Each day row has input fields for **Allowance** (Minutes) and **Active Window** (Start/End).
    - **Quick Actions:** "Copy to Weekdays" and "Copy to Weekends" buttons to avoid repetitive data entry.
- **Child View (The Forecast):**
    - Displays the schedule as a "Weekly Forecast" row.
    - **Content:** Shows **only** the Allowance limit (Diamonds/Minutes). Time windows are hidden to reduce cognitive load and emphasize autonomy.
    - **Current Day:** Highlighted with big, bold status (as per Section 10).
    - **Upcoming:** Shows future days with their allowance limits so the child can plan banking strategies (e.g., "Tomorrow is a short day, I should bank time today").

## 4. User Journeys

### Journey 1: The Responsible Session

1. **Start:** Child sits down, opens ClockBlock web dashboard. Sees "Today: 60 mins."
2. **Play:** Launches Minecraft. The dashboard updates to "Status: Online" and bar begins draining.
3. **Stop:** Child finishes with 10 mins left. Closes Minecraft.
4. **Result:** 10 mins added to "Weekend Bank."

### Journey 2: The Overdraft (Lesson Learned)

1. **Context:** Child is deep in a cave, timer hits 0.
2. **Decision:** Decides to keep playing to find diamonds.
3. **Feedback:** Dashboard bar turns **Red**. Text changes to "Overdraft: -1 min (Cost: -2 mins tomorrow)."
4. **Consequence:** Plays 15 mins over. Total debt cost: 30 mins.
5. **Next Day:** Opens app. "Today's Budget: 30 mins (60 - 30 penalty)."

## 5. Data Model (Supabase Schema Draft)

**Table: `users`**

- `id`: UUID
- `username`: String
- `role`: 'child' | 'parent'

**Table: `daily_logs`**

- `user_id`: UUID
- `date`: Date
- `minutes_played`: Int
- `minutes_added`: Int (Manual grants)
- `minutes_penalty`: Int (Debt from previous day)
- `banked_minutes`: Int

**Table: `daily_rules`**

- `day_of_week`: Int (0=Sun, 6=Sat)
- `allowance_minutes`: Int
- `window_start`: Time (08:00)
- `window_end`: Time (20:00)
- `is_strict_window`: Boolean

**Table: `config`**

- `overdraft_multiplier`: 2.0
- `default_timezone`: String

## 6. Risk Assessment & Edge Cases (The "Devil's Advocate" Section)

### A. The "Offline" Loophole

- **Risk:** Internet drops (or is unplugged). Script cannot ping Supabase.
- **Handling:**
    - **Local Caching:** The script must log minutes locally to a temporary file.
    - **Sync:** On reconnection, script uploads the pending log.
    - **Visuals:** Dashboard shows "OFFLINE MODE - Still Tracking" (Yellow/Amber state) to remove ambiguity.

### B. The "Kill Switch" (Cheating)

- **Risk:** Child opens Task Manager and kills the Python script.
- **Mitigation (Social, not Technical):**
    - We do not try to hide the process or run as Root/Admin (too complex/fragile).
    - **The "Heartbeat" Rule:** The Parent Dashboard shows "Last Sync". If it says "Last seen: 2 hours ago" but he is playing, the parent applies a Manual Penalty (God Mode).
    - **Lesson:** "If you kill the referee, you forfeit the game."
    - **Education:** This rule is explicitly explained in the Onboarding flow (see Section 8).

### C. The "Midnight" Edge Case

- **Risk:** Playing across the 4:00 AM reset time.
- **Handling:** The script logic handles the rollover. If session spans 3:50 AM to 4:10 AM, 10 mins go to "Yesterday" and 10 mins to "Today".

## 7. Lessons from Incumbents (Screen Time / Family Link)

- **Transparency > Black Box:** Kids hate not knowing *why* something happened. The UI must be explicit: "You have -10 minutes because you played over yesterday."
- **Latency Causes Fights:** "It said I had 1 minute left!" vs. "It says 0!".
    - *Solution:* The Local Script is the "Source of Truth" for the HUD. It calculates locally to prevent lag, then syncs to cloud.

## 8. Onboarding & Education (The "Rulebook")

**Goal:** Visually explain the "Trust Model" so both parties understand the mechanics before the first session.

- **For the Child (The "Tutorial"):**
    - **Visual 1:** "The Referee." Shows a cartoon whistle. *Text: "ClockBlock watches the game. If you turn off the Referee, you get a Red Card (Manual Penalty)."*
    - **Visual 2:** "The Bank." Shows a piggy bank. *Text: "Save minutes for the weekend."*
    - **Visual 3:** "The Credit Card." Shows a red card. *Text: "You can keep playing when time is up, but it costs DOUBLE for tomorrow."*
- **For the Parent (The "Dash"):**
    - **Tooltip on "Last Sync":** "If this is old but he is playing, the script is off. Apply Penalty."

## 9. Future Roadmap (AI Features - Post MVP)

These features leverage Generative AI (Gemini/GPT) to enhance the psychological "hook" of the system, turning data into narrative.

### A. The "Enderman" Weekly Recap (RPG Storytelling)

- **Concept:** Instead of a boring chart, the AI generates a Minecraft-themed "Adventure Log" based on actual data.
- **Input:** Usage logs (e.g., "Overdrafted on Tuesday", "Banked 10 mins Wednesday").
- **Output:** A short story. *Example: "This week, you were a Redstone Engineer. You carefully saved power on Wednesday, but the Tuesday Overdraft Creepers almost blew up your stash."*
- **Value:** Rewards discipline with narrative lore.

### B. The "Smart Villager" (Context-Aware Nudges)

- **Concept:** Replace static warnings with an AI persona that comments on the specific context.
- **Scenario A (Rich):** "Hrmm. You are rich in time today. A true merchant."
- **Scenario B (Risky):** "Careful! You are about to enter the Nether (Overdraft). Is it worth double diamonds tomorrow?"
- **Value:** Feels like a Game Companion, not a Parent Bot.

### C. Predictive Budgeting (The "Forecaster")

- **Concept:** AI analyzes habits and warns *before* a mistake is made.
- **Insight:** "You usually play 3 hours on Saturday. You only have 2 hours banked. If you play tonight, you won't have enough."
- **Value:** Teaches **Planning Ahead** (Executive Function).

## 10. Visual Design Guidelines (The Look & Feel)

**Critique of V2:** The previous iteration was "too nerdy" (too much like a hacker terminal) and elements were too small.

- **Design Principle:** "Big, Bold, & Chunky." Think **Nintendo Switch UI** or **Clash of Clans**, not a terminal.
- **Scale Rule:**
    - **The Hero:** The "Time Remaining" number must be **massive** (e.g., 20% of screen height). Readable from across the room.
    - **Buttons:** oversized, "juicy" buttons that look clickable.
- **The Vibe:** Playful, not "Hackerman." Use Minecraft aesthetic (blocks/pixels) but keep it bright and approachable.
- **Palette:**
    - **Background:** Dark, but not pitch black. Use a rich deep blue or purple (e.g., `#1A1B26`).
    - **Accents:** Bright, neon-ish Minecraft colors. Diamond Blue, Creeper Green, TNT Red.
- **Typography:**
    - **Headers:** Use **Native System Fonts** in their heaviest weight (e.g., `Impact`, `Arial Black`, or System UI with `font-weight: 900`). No imports.
    - **Body:** Standard System Sans-Serif (`-apple-system`, `Segoe UI`, etc.) for maximum performance.
    - **Scale:** Scale up text size to compensate for the lack of decorative fonts. Headers should be huge.
- **Components:**
    - **Navigation:** Left Sidebar (Modern App Style).
        - Fixed width, dark semi-transparent background (Glassmorphism).
        - Big icons with text labels (Dashboard, History, Parent Mode).
        - Active state: Glowing border or bright background highlight (Diamond Blue).
    - **Budget Bar:** Thick, glossy bar (like a health bar in a modern RPG), not a thin line.
    - **Cards:** Big padding, rounded corners (or distinct block corners), high contrast borders.

## 11. Final Polish Instructions (The "Juice")

- **Typography:** Tighten the letter-spacing on the huge headers (`tracking-tighter` or `-0.05em`) to make them look like logos.
- **Depth:** Add "Inner Shadow" (`shadow-inner`) to the Budget Bar (liquid effect) and "Drop Shadow" (`shadow-xl`) to Cards (pop effect).
- **Interaction:** Ensure all interactive elements have a `hover:brightness-110` or `hover:scale-105` micro-interaction.